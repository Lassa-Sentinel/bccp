% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bccp.R
\name{bccp}
\alias{bccp}
\title{Bin-Conditional Conformal Prediction}
\usage{
bccp(
  calib_set,
  test_set,
  y_col = "y",
  pred_col = "pred",
  id_col = NULL,
  n_bins = 4,
  zero_bin = TRUE,
  alpha = 0.05,
  grid_length = 1000,
  return_full = FALSE,
  seed = 42
)
}
\arguments{
\item{calib_set}{Calibration data frame containing observed values and predictions}

\item{test_set}{Test data frame to receive prediction intervals}

\item{y_col}{Name of the response column (default: "y")}

\item{pred_col}{Name of the prediction column (default: "pred")}

\item{id_col}{Optional column name with row IDs}

\item{n_bins}{Number of bins for outcome values}

\item{zero_bin}{Whether to use a separate bin for zeros (useful for count data)}

\item{alpha}{Target miscoverage rate (e.g., 0.1 for 90\% coverage)}

\item{grid_length}{Number of grid points for interval construction}

\item{return_full}{If TRUE, returns all bin-wise intervals}

\item{seed}{Random seed for reproducibility}
}
\value{
Data frame with prediction intervals (lower, upper columns)
}
\description{
Implements bin-conditional conformal prediction for generating valid
prediction intervals. Based on Blair, Coppock & Moor (2024).
}
\examples{
# Generate synthetic data
set.seed(42)
n <- 500
x <- runif(n, 0, 10)
y <- rpois(n, lambda = exp(0.5 + 0.2 * x))
pred <- exp(0.5 + 0.2 * x)  # True mean

# Split into calibration and test
calib_idx <- 1:400
test_idx <- 401:500

calib_set <- data.frame(y = y[calib_idx], pred = pred[calib_idx])
test_set <- data.frame(y = y[test_idx], pred = pred[test_idx])

# Apply BCCP
result <- bccp(calib_set, test_set, alpha = 0.1)

# Check coverage
coverage <- mean(result$y >= result$lower & result$y <= result$upper)
cat("Coverage:", round(coverage, 3), "\n")
}
\references{
Blair, G., Coppock, A., & Moor, M. (2024). Bin-Conditional Conformal Prediction.
arXiv:2410.14507. \url{https://arxiv.org/abs/2410.14507}
}
